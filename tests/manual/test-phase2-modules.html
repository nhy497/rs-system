<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>éšæ®µ 2 æ¨¡çµ„æ¸¬è©¦ - æ ¸å¿ƒæœå‹™</title>
  <style>
    body { font-family: sans-serif; max-width: 900px; margin: 50px auto; padding: 20px; background: #f5f5f5; }
    h1 { color: #333; border-bottom: 3px solid #2196f3; padding-bottom: 10px; }
    .test-section { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .test-section h2 { color: #2196f3; margin-top: 0; }
    .result { background: #f9f9f9; padding: 10px; margin: 10px 0; font-family: monospace; font-size: 14px; border-left: 4px solid #4caf50; }
    .result.fail { border-left-color: #f44336; }
    button { background: #2196f3; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin: 5px; }
    button:hover { background: #1976d2; }
  </style>
</head>
<body>
  <h1>ğŸ”§ éšæ®µ 2ï¼šæ ¸å¿ƒæœå‹™æ¨¡çµ„æ¸¬è©¦</h1>

  <div class="test-section">
    <h2>æ¸¬è©¦ 1ï¼šæ¨¡çµ„åŒ¯å…¥</h2>
    <div id="test-import" class="result"></div>
  </div>

  <div class="test-section">
    <h2>æ¸¬è©¦ 2ï¼šSTORAGE_MANAGER API</h2>
    <div id="test-storage" class="result"></div>
  </div>

  <div class="test-section">
    <h2>æ¸¬è©¦ 3ï¼šRecordsService API</h2>
    <div id="test-records" class="result"></div>
  </div>

  <div class="test-section">
    <h2>æ¸¬è©¦ 4ï¼šLOGIN_MANAGER API</h2>
    <div id="test-login" class="result"></div>
  </div>

  <div class="test-section">
    <h2>æ¸¬è©¦ 5ï¼šç„¡å¾ªç’°ä¾è³´</h2>
    <div id="test-deps" class="result"></div>
  </div>

  <div class="test-section">
    <h2>æ¸¬è©¦ 6ï¼šå®Œæ•´æ€§é©—è­‰</h2>
    <button onclick="runAllTests()">åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦</button>
    <div id="test-summary" class="result"></div>
  </div>

  <script type="module">
    async function runAllTests() {
      const results = [];
      
      // æ¸¬è©¦ 1: æ¨¡çµ„åŒ¯å…¥
      try {
        const { STORAGE_MANAGER, LOGIN_MANAGER, RecordsService } = await import('./src/main.js');
        document.getElementById('test-import').textContent = 'âœ… æ‰€æœ‰æ¨¡çµ„åŒ¯å…¥æˆåŠŸ';
        document.getElementById('test-import').className = 'result';
        results.push(true);
      } catch (e) {
        document.getElementById('test-import').textContent = 'âŒ åŒ¯å…¥å¤±æ•—ï¼š' + e.message;
        document.getElementById('test-import').className = 'result fail';
        results.push(false);
      }

      // æ¸¬è©¦ 2: STORAGE_MANAGER
      try {
        const { STORAGE_MANAGER } = await import('./src/main.js');
        const hasLoadData = typeof STORAGE_MANAGER.loadData === 'function';
        const hasSaveData = typeof STORAGE_MANAGER.saveData === 'function';
        document.getElementById('test-storage').textContent = 
          hasLoadData && hasSaveData ? 
          'âœ… STORAGE_MANAGER API å®Œæ•´ (loadData, saveData)' : 
          'âŒ STORAGE_MANAGER API ä¸å®Œæ•´';
        document.getElementById('test-storage').className = hasLoadData && hasSaveData ? 'result' : 'result fail';
        results.push(hasLoadData && hasSaveData);
      } catch (e) {
        document.getElementById('test-storage').textContent = 'âŒ éŒ¯èª¤ï¼š' + e.message;
        document.getElementById('test-storage').className = 'result fail';
        results.push(false);
      }

      // æ¸¬è©¦ 3: RecordsService
      try {
        const { RecordsService } = await import('./src/main.js');
        const hasGetAll = typeof RecordsService.getAllRecords === 'function';
        const hasCreate = typeof RecordsService.createRecord === 'function';
        document.getElementById('test-records').textContent = 
          hasGetAll && hasCreate ? 
          'âœ… RecordsService API å®Œæ•´ (getAllRecords, createRecord)' : 
          'âŒ RecordsService API ä¸å®Œæ•´';
        document.getElementById('test-records').className = hasGetAll && hasCreate ? 'result' : 'result fail';
        results.push(hasGetAll && hasCreate);
      } catch (e) {
        document.getElementById('test-records').textContent = 'âŒ éŒ¯èª¤ï¼š' + e.message;
        document.getElementById('test-records').className = 'result fail';
        results.push(false);
      }

      // æ¸¬è©¦ 4: LOGIN_MANAGER
      try {
        const { LOGIN_MANAGER } = await import('./src/main.js');
        const hasCheck = typeof LOGIN_MANAGER.checkSession === 'function';
        const hasLogin = typeof LOGIN_MANAGER.login === 'function';
        document.getElementById('test-login').textContent = 
          hasCheck && hasLogin ? 
          'âœ… LOGIN_MANAGER API å®Œæ•´ (checkSession, login)' : 
          'âŒ LOGIN_MANAGER API ä¸å®Œæ•´';
        document.getElementById('test-login').className = hasCheck && hasLogin ? 'result' : 'result fail';
        results.push(hasCheck && hasLogin);
      } catch (e) {
        document.getElementById('test-login').textContent = 'âŒ éŒ¯èª¤ï¼š' + e.message;
        document.getElementById('test-login').className = 'result fail';
        results.push(false);
      }

      // æ¸¬è©¦ 5: ç„¡å¾ªç’°ä¾è³´
      try {
        await import('./src/main.js');
        document.getElementById('test-deps').textContent = 'âœ… ç„¡å¾ªç’°ä¾è³´éŒ¯èª¤';
        document.getElementById('test-deps').className = 'result';
        results.push(true);
      } catch (e) {
        document.getElementById('test-deps').textContent = 'âŒ å¾ªç’°ä¾è³´ï¼š' + e.message;
        document.getElementById('test-deps').className = 'result fail';
        results.push(false);
      }

      // æ¸¬è©¦æ‘˜è¦
      const passed = results.filter(r => r).length;
      const total = results.length;
      document.getElementById('test-summary').textContent = 
        `æ¸¬è©¦å®Œæˆï¼š${passed}/${total} é€šé`;
      document.getElementById('test-summary').className = 
        passed === total ? 'result' : 'result fail';
    }

    window.runAllTests = runAllTests;
    runAllTests();
  </script>
</body>
</html>
