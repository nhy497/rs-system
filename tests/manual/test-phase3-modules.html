<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Phase 3 æ¨¡çµ„æ¸¬è©¦</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
      background: #f5f5f5;
    }
    h1 {
      color: #333;
      border-bottom: 2px solid #007bff;
      padding-bottom: 0.5rem;
    }
    .test-section {
      background: white;
      padding: 1.5rem;
      margin: 1rem 0;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .test-section h2 {
      color: #007bff;
      margin-top: 0;
    }
    .status {
      padding: 0.5rem 1rem;
      border-radius: 4px;
      margin: 0.5rem 0;
      font-family: monospace;
    }
    .success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    .error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    .info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
      margin: 0.25rem;
    }
    button:hover {
      background: #0056b3;
    }
    #output {
      margin-top: 1rem;
      padding: 1rem;
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      min-height: 100px;
      max-height: 400px;
      overflow-y: auto;
    }
    .code {
      font-family: monospace;
      background: #f4f4f4;
      padding: 2px 6px;
      border-radius: 3px;
    }
  </style>
</head>
<body>
  <h1>ğŸ¯ Phase 3 UI ç®¡ç†æ¨¡çµ„æ¸¬è©¦é é¢</h1>
  
  <div class="test-section">
    <h2>ğŸ“¦ æ¨¡çµ„è¼‰å…¥æ¸¬è©¦</h2>
    <p>æ­¤é é¢æ¸¬è©¦æ‰€æœ‰ Phase 3 UI ç®¡ç†æ¨¡çµ„æ˜¯å¦å¯ä»¥æ­£å¸¸è¼‰å…¥å’Œä½¿ç”¨ã€‚</p>
    <div id="import-status"></div>
  </div>

  <div class="test-section">
    <h2>ğŸ§ª åŠŸèƒ½æ¸¬è©¦</h2>
    <button onclick="testUIManager()">æ¸¬è©¦ UI Manager</button>
    <button onclick="testFormManager()">æ¸¬è©¦ Form Manager</button>
    <button onclick="testTricksManager()">æ¸¬è©¦ Tricks Manager</button>
    <button onclick="testAttachmentsManager()">æ¸¬è©¦ Attachments Manager</button>
    <button onclick="testListRenderer()">æ¸¬è©¦ List Renderer</button>
    <button onclick="testModalManager()">æ¸¬è©¦ Modal Manager</button>
    <button onclick="testEventHandlers()">æ¸¬è©¦ Event Handlers</button>
    <button onclick="runAllTests()">åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦</button>
    <div id="output"></div>
  </div>

  <div class="test-section">
    <h2>ğŸ“Š æ¨¡çµ„è³‡è¨Š</h2>
    <ul>
      <li><code class="code">ui-manager.js</code> - UI ç®¡ç†å™¨ (276 è¡Œ)</li>
      <li><code class="code">form-manager.js</code> - è¡¨å–®ç®¡ç†å™¨ (531 è¡Œ)</li>
      <li><code class="code">tricks-manager.js</code> - èŠ±å¼ç®¡ç†å™¨ (313 è¡Œ)</li>
      <li><code class="code">attachments-manager.js</code> - é™„ä»¶ç®¡ç†å™¨ (435 è¡Œ)</li>
      <li><code class="code">list-renderer.js</code> - åˆ—è¡¨æ¸²æŸ“å™¨ (476 è¡Œ)</li>
      <li><code class="code">modal-manager.js</code> - æ¨¡æ…‹ç®¡ç†å™¨ (434 è¡Œ)</li>
      <li><code class="code">event-handlers.js</code> - äº‹ä»¶è™•ç†å™¨ (571 è¡Œ)</li>
    </ul>
    <p><strong>ç¸½è¨ˆ:</strong> 7 å€‹æ¨¡çµ„ï¼Œç´„ 3,036 è¡Œä»£ç¢¼</p>
  </div>

  <script type="module">
    // è¼‰å…¥æ‰€æœ‰æ¨¡çµ„
    let modules = {};
    const output = document.getElementById('output');
    const importStatus = document.getElementById('import-status');
    
    function log(message, type = 'info') {
      const div = document.createElement('div');
      div.className = `status ${type}`;
      div.textContent = message;
      output.appendChild(div);
      output.scrollTop = output.scrollHeight;
    }
    
    async function loadModules() {
      importStatus.innerHTML = '<p>æ­£åœ¨è¼‰å…¥æ¨¡çµ„...</p>';
      
      try {
        modules.UI_MANAGER = (await import('./src/ui/ui-manager.js')).UI_MANAGER;
        importStatus.innerHTML += '<div class="status success">âœ… UI Manager è¼‰å…¥æˆåŠŸ</div>';
        
        modules.FormManager = (await import('./src/ui/form-manager.js')).FormManager;
        importStatus.innerHTML += '<div class="status success">âœ… Form Manager è¼‰å…¥æˆåŠŸ</div>';
        
        modules.TricksManager = (await import('./src/ui/tricks-manager.js')).TricksManager;
        importStatus.innerHTML += '<div class="status success">âœ… Tricks Manager è¼‰å…¥æˆåŠŸ</div>';
        
        modules.AttachmentsManager = (await import('./src/ui/attachments-manager.js')).AttachmentsManager;
        importStatus.innerHTML += '<div class="status success">âœ… Attachments Manager è¼‰å…¥æˆåŠŸ</div>';
        
        modules.ListRenderer = (await import('./src/ui/list-renderer.js')).ListRenderer;
        importStatus.innerHTML += '<div class="status success">âœ… List Renderer è¼‰å…¥æˆåŠŸ</div>';
        
        modules.ModalManager = (await import('./src/ui/modal-manager.js')).ModalManager;
        importStatus.innerHTML += '<div class="status success">âœ… Modal Manager è¼‰å…¥æˆåŠŸ</div>';
        
        modules.EventHandlers = (await import('./src/ui/event-handlers.js')).EventHandlers;
        importStatus.innerHTML += '<div class="status success">âœ… Event Handlers è¼‰å…¥æˆåŠŸ</div>';
        
        importStatus.innerHTML += '<div class="status success"><strong>ğŸ‰ æ‰€æœ‰æ¨¡çµ„è¼‰å…¥æˆåŠŸï¼</strong></div>';
        
      } catch (error) {
        importStatus.innerHTML += `<div class="status error">âŒ è¼‰å…¥å¤±æ•—: ${error.message}</div>`;
        console.error('Module loading error:', error);
      }
    }
    
    // æ¸¬è©¦å‡½æ•¸
    window.testUIManager = function() {
      output.innerHTML = '';
      log('=== æ¸¬è©¦ UI Manager ===');
      
      try {
        log('åˆå§‹åŒ– UI Manager...', 'info');
        const result = modules.UI_MANAGER.init();
        log(`åˆå§‹åŒ–çµæœ: ${result}`, result ? 'success' : 'error');
        
        log('æ¸¬è©¦é€šçŸ¥ç³»çµ±...', 'info');
        modules.UI_MANAGER.showNotification('é€™æ˜¯æ¸¬è©¦è¨Šæ¯', 'info');
        log('é€šçŸ¥ç³»çµ±æ¸¬è©¦å®Œæˆ', 'success');
        
        log('âœ… UI Manager æ¸¬è©¦é€šé', 'success');
      } catch (error) {
        log(`âŒ UI Manager æ¸¬è©¦å¤±æ•—: ${error.message}`, 'error');
      }
    };
    
    window.testFormManager = function() {
      output.innerHTML = '';
      log('=== æ¸¬è©¦ Form Manager ===');
      
      try {
        log('æ¸¬è©¦è¡¨å–®æ¨¡å¼è¨­ç½®...', 'info');
        modules.FormManager.setFormMode('edit');
        const mode = modules.FormManager.getFormMode();
        log(`ç•¶å‰æ¨¡å¼: ${mode}`, mode === 'edit' ? 'success' : 'error');
        
        log('âœ… Form Manager æ¸¬è©¦é€šé', 'success');
      } catch (error) {
        log(`âŒ Form Manager æ¸¬è©¦å¤±æ•—: ${error.message}`, 'error');
      }
    };
    
    window.testTricksManager = function() {
      output.innerHTML = '';
      log('=== æ¸¬è©¦ Tricks Manager ===');
      
      try {
        log('æ·»åŠ èŠ±å¼...', 'info');
        modules.TricksManager.clearSelection();
        modules.TricksManager.addTrick({
          name: 'æ¸¬è©¦èŠ±å¼',
          level: 'åˆç´š',
          mastery: 75
        });
        
        const tricks = modules.TricksManager.getSelectedTricks();
        log(`å·²æ·»åŠ  ${tricks.length} å€‹èŠ±å¼`, tricks.length > 0 ? 'success' : 'error');
        
        log('âœ… Tricks Manager æ¸¬è©¦é€šé', 'success');
      } catch (error) {
        log(`âŒ Tricks Manager æ¸¬è©¦å¤±æ•—: ${error.message}`, 'error');
      }
    };
    
    window.testAttachmentsManager = function() {
      output.innerHTML = '';
      log('=== æ¸¬è©¦ Attachments Manager ===');
      
      try {
        log('åˆå§‹åŒ–é™„ä»¶ç®¡ç†å™¨...', 'info');
        modules.AttachmentsManager.init();
        
        log('æ¸¬è©¦æ–‡ä»¶å¤§å°æ ¼å¼åŒ–...', 'info');
        const size = modules.AttachmentsManager.formatFileSize(1024 * 1024);
        log(`æ ¼å¼åŒ–çµæœ: ${size}`, size === '1.0 MB' ? 'success' : 'info');
        
        log('âœ… Attachments Manager æ¸¬è©¦é€šé', 'success');
      } catch (error) {
        log(`âŒ Attachments Manager æ¸¬è©¦å¤±æ•—: ${error.message}`, 'error');
      }
    };
    
    window.testListRenderer = function() {
      output.innerHTML = '';
      log('=== æ¸¬è©¦ List Renderer ===');
      
      try {
        log('æ¸¬è©¦æ’åºåŠŸèƒ½...', 'info');
        const records = [
          { classDate: '2024-01-15', className: 'Aç­' },
          { classDate: '2024-01-14', className: 'Bç­' }
        ];
        
        const sorted = modules.ListRenderer.sortRecords(records, 'date-desc');
        log(`æ’åºå®Œæˆï¼Œè¨˜éŒ„æ•¸: ${sorted.length}`, sorted.length === 2 ? 'success' : 'error');
        
        log('âœ… List Renderer æ¸¬è©¦é€šé', 'success');
      } catch (error) {
        log(`âŒ List Renderer æ¸¬è©¦å¤±æ•—: ${error.message}`, 'error');
      }
    };
    
    window.testModalManager = function() {
      output.innerHTML = '';
      log('=== æ¸¬è©¦ Modal Manager ===');
      
      try {
        log('æ¸¬è©¦æ¨¡æ…‹ç‹€æ…‹...', 'info');
        const current = modules.ModalManager.getCurrentModal();
        log(`ç•¶å‰æ¨¡æ…‹: ${current || 'ç„¡'}`, 'info');
        
        log('âœ… Modal Manager æ¸¬è©¦é€šé', 'success');
      } catch (error) {
        log(`âŒ Modal Manager æ¸¬è©¦å¤±æ•—: ${error.message}`, 'error');
      }
    };
    
    window.testEventHandlers = function() {
      output.innerHTML = '';
      log('=== æ¸¬è©¦ Event Handlers ===');
      
      try {
        log('æ¸¬è©¦è‡ªè¨‚äº‹ä»¶ç³»çµ±...', 'info');
        
        modules.EventHandlers.on('testEvent', (data) => {
          log(`æ”¶åˆ°äº‹ä»¶: ${JSON.stringify(data)}`, 'success');
        });
        
        modules.EventHandlers.emit('testEvent', { test: true });
        
        log('âœ… Event Handlers æ¸¬è©¦é€šé', 'success');
      } catch (error) {
        log(`âŒ Event Handlers æ¸¬è©¦å¤±æ•—: ${error.message}`, 'error');
      }
    };
    
    window.runAllTests = function() {
      output.innerHTML = '';
      log('ğŸš€ é–‹å§‹åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦...\n', 'info');
      
      setTimeout(() => testUIManager(), 100);
      setTimeout(() => testFormManager(), 500);
      setTimeout(() => testTricksManager(), 900);
      setTimeout(() => testAttachmentsManager(), 1300);
      setTimeout(() => testListRenderer(), 1700);
      setTimeout(() => testModalManager(), 2100);
      setTimeout(() => testEventHandlers(), 2500);
      setTimeout(() => log('\nâœ… æ‰€æœ‰æ¸¬è©¦åŸ·è¡Œå®Œæˆï¼', 'success'), 3000);
    };
    
    // é é¢è¼‰å…¥æ™‚è‡ªå‹•è¼‰å…¥æ¨¡çµ„
    loadModules();
  </script>
</body>
</html>
