<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>HKJRA æ•™ç·´è¨˜éŒ„ç³»çµ± Â· è·³ç¹©èª²å ‚ Checkpoint</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- PouchDB æ ¸å¿ƒåº« -->
  <script src="https://cdn.jsdelivr.net/npm/pouchdb@8.0.1/dist/pouchdb.min.js"></script>
  <!-- PouchDB ç›¸å®¹ç´¢å¼•å¤–æ› -->
  <script src="https://cdn.jsdelivr.net/npm/pouchdb-find@8.0.1/dist/pouchdb.find.min.js"></script>
</head>
<body>
  <div class="app">
    <!-- å´é‚Šæ¬„ -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-brand">
        <span class="brand-icon">â—‡</span>
        <span class="brand-text">æ•™ç·´è¨˜éŒ„ç³»çµ±</span>
      </div>

      <!-- ç”¨æˆ¶ä¿¡æ¯å€ -->
      <div class="sidebar-user" id="sidebarUser">
        <div class="user-avatar">ğŸ‘¤</div>
        <div class="user-info">
          <div class="user-name" id="sidebarUserName">æœªç™»éŒ„</div>
          <div class="user-role" id="sidebarUserRole">è¨ªå®¢</div>
        </div>
      </div>

      <!-- å¿«é€Ÿçµ±è¨ˆ -->
      <div class="sidebar-stats">
        <div class="stat-item">
          <div class="stat-label">ä»Šæ—¥èª²å ‚</div>
          <div class="stat-value" id="todayCount">0</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">å­¸ç”Ÿç¸½æ•¸</div>
          <div class="stat-value" id="totalStudents">0</div>
        </div>
      </div>

      <!-- ä¸»èœå–® -->
      <nav class="sidebar-nav">
        <div class="nav-section-title">ä¸»èœå–®</div>
        <a href="#" class="nav-item active" data-page="overview">
          <span class="nav-icon">â–£</span>
          <span class="nav-label">èª²å ‚æ¦‚è¦½</span>
        </a>
        <a href="#" class="nav-item" data-page="students">
          <span class="nav-icon">â—</span>
          <span class="nav-label">å­¸ç”Ÿç®¡ç†</span>
        </a>
        <a href="#" class="nav-item" data-page="actions">
          <span class="nav-icon">â—†</span>
          <span class="nav-label">å‹•ä½œè¨˜éŒ„</span>
        </a>
        <a href="#" class="nav-item" data-page="analytics">
          <span class="nav-icon">â–¤</span>
          <span class="nav-label">çµ±è¨ˆåˆ†æ</span>
        </a>

        <div class="nav-section-title">å·¥å…·</div>
        <a href="#" class="nav-item" id="navData" data-page="data" hidden>
          <span class="nav-icon">ğŸ‘¥</span>
          <span class="nav-label">ç”¨æˆ¶ç®¡ç†</span>
        </a>
        <a href="#" class="nav-item" id="btnExport">
          <span class="nav-icon">â¬‡ï¸</span>
          <span class="nav-label">å°å‡ºæ•¸æ“š</span>
        </a>
        <a href="#" class="nav-item" id="btnSettings">
          <span class="nav-icon">âš™ï¸</span>
          <span class="nav-label">ç³»çµ±è¨­ç½®</span>
        </a>
      </nav>

      <!-- åº•éƒ¨ä¿¡æ¯ -->
      <div class="sidebar-footer">
        <div class="footer-info">
          <div class="footer-tag">HKJRA åˆä½œ</div>
          <div class="footer-version">v2.1.1</div>
        </div>
        <button type="button" class="btn-logout" id="btnLogout" aria-label="ç™»å‡º">
          <span class="logout-icon">ğŸšª</span>
          <span>ç™»å‡º</span>
        </button>
      </div>
    </aside>

    <!-- ä¸»é«” -->
    <div class="main-wrap">
      <!-- é ‚éƒ¨å·¥å…·æ¢ -->
      <header class="topbar">
        <button type="button" class="topbar-menu" id="sidebarToggle" aria-label="é¸å–®">â˜°</button>
        <h1 class="topbar-title" id="topbarTitle">èª²å ‚æ¦‚è¦½</h1>
        <div class="topbar-meta">
          <div class="topbar-filter">
            <label for="globalFilterClass">ç­åˆ¥</label>
            <select id="globalFilterClass">
              <option value="">å…¨éƒ¨</option>
            </select>
          </div>
          <span class="topbar-date" id="topbarDate"></span>
        </div>
      </header>

      <!-- å…§å®¹å€ -->
      <main class="content">
        <!-- é é¢ï¼šèª²å ‚æ¦‚è¦½ -->
        <section id="page-overview" class="page active">
          <div class="page-inner overview-grid">
            <!-- åŸºæœ¬è³‡æ–™ -->
            <div class="card">
              <h2 class="card-title">ğŸ“‹ åŸºæœ¬è³‡æ–™</h2>
              <div class="card-body form-grid-3">
                <div class="field">
                  <label for="classDate">èª²å ‚æ—¥æœŸ <span class="required">*</span></label>
                  <input type="date" id="classDate" required>
                </div>
                <div class="field">
                  <label for="className">ç­ç´šåç¨±</label>
                  <div class="quick-class-wrap">
                    <input type="text" id="className" placeholder="ä¾‹ï¼šP3A / åˆç´šç­">
                    <label for="quickSelectClass">å¿«é€Ÿé¸æ“‡</label>
                    <select id="quickSelectClass">
                      <option value="">â€”</option>
                    </select>
                  </div>
                </div>
                <div class="field">
                  <label for="classSize">äººæ•¸ <span class="required">*</span></label>
                  <input type="number" id="classSize" min="0" placeholder="äººæ•¸">
                </div>
              </div>
              <!-- ç­ç´šé è¨­æŒ‰éˆ•å®¹å™¨ï¼ˆç”±JSæ·»åŠ ï¼‰ -->
              <div id="classPresetsContainer" class="class-presets" style="display: none;"></div>
              
              <!-- èª²å ‚æ™‚é–“ -->
              <div class="field-row">
                <div class="field">
                  <label for="classStartTime">é–‹å§‹æ™‚é–“</label>
                  <input type="time" id="classStartTime">
                </div>
                <div class="field">
                  <label for="classEndTime">çµæŸæ™‚é–“</label>
                  <input type="time" id="classEndTime">
                </div>
              </div>
              
              <!-- èª²å ‚æ™‚é•·é¡¯ç¤º -->
              <div id="classDuration" class="time-duration-display">èª²å ‚æ™‚é•·ï¼šâ€”</div>
              
              <!-- èª²å ‚ä½ç½®èˆ‡æ•™å­¸è§’è‰² -->
              <div class="field-row">
                <div class="field">
                  <label for="classLocation">èª²å ‚ä½ç½®</label>
                  <input type="text" id="classLocation" placeholder="ä¾‹ï¼šæ“å ´ã€é«”è‚²é¤¨">
                </div>
                <div class="field">
                  <label for="teachingRole">æ•™å­¸è§’è‰²</label>
                  <input type="text" id="teachingRole" placeholder="ä¾‹ï¼šä¸»æ•™ç·´ã€åŠ©æ•™">
                </div>
              </div>
              
              <!-- å‚™æ³¨ -->
              <div class="field" style="padding: 0 1.25rem 1.25rem;">
                <label for="notes">å‚™æ³¨</label>
                <textarea id="notes" rows="2" placeholder="èª²å ‚è§€å¯Ÿã€å¾…è·Ÿé€²ã€ä¸‹å ‚é å‘Šâ€¦"></textarea>
              </div>
            </div>

            <!-- æŠ•å…¥åº¦ -->
            <div class="card card-engagement">
              <h2 class="card-title">ğŸ˜Š æŠ•å…¥åº¦</h2>
              <div class="card-body">
                <div class="field">
                  <label>é–‹å¿ƒæŒ‡æ•¸ <span class="range-val" id="val-engagement">3</span>/5</label>
                  <div class="slider-row">
                    <input type="range" id="engagement" min="1" max="5" value="3">
                    <div class="quick-btns" data-target="engagement">
                      <button type="button" data-v="1">1</button>
                      <button type="button" data-v="2">2</button>
                      <button type="button" data-v="3" class="active">3</button>
                      <button type="button" data-v="4">4</button>
                      <button type="button" data-v="5">5</button>
                    </div>
                  </div>
                </div>
                <div class="field">
                  <label>èª²å ‚æ°£æ°› <span class="required">*</span></label>
                  <div class="option-btns" data-name="atmosphere">
                    <button type="button" data-v="é–‹å¿ƒ">é–‹å¿ƒ</button>
                    <button type="button" data-v="ä¸é–‹å¿ƒ">ä¸é–‹å¿ƒ</button>
                    <button type="button" data-v="èªçœŸå­¸ç¿’">èªçœŸå­¸ç¿’</button>
                    <button type="button" data-v="å¿ƒæ•£">å¿ƒæ•£</button>
                    <button type="button" data-v="ä¸€èˆ¬">ä¸€èˆ¬</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- æŠ€èƒ½é€²æ­¥ -->
            <div class="card card-skills">
              <h2 class="card-title">ğŸ¯ æŠ€èƒ½é€²æ­¥</h2>
              <div class="card-body">
                <div class="field">
                  <label>æ•™å­¸èŠ±å¼ <span class="required">*</span></label>
                  <div id="tricksList" class="tricks-list"></div>
                  <div class="trick-item add-trick">
                    <input type="text" id="trickName" placeholder="èŠ±å¼åç¨±">
                    <input type="text" id="trickDetail" placeholder="æ•™å­¸ç´°ç¯€ï¼ˆé¸å¡«ï¼‰">
                    <button type="button" id="addTrick" class="btn-add">+ æ–°å¢</button>
                  </div>
                </div>
                <div class="field">
                  <label>æŒæ¡æ¯”ä¾‹ <span class="range-val" id="val-mastery">50</span>%</label>
                  <div class="slider-row">
                    <input type="range" id="mastery" min="0" max="100" value="50">
                    <div class="quick-btns quick-pct" data-target="mastery">
                      <button type="button" data-v="0">0%</button>
                      <button type="button" data-v="25">25%</button>
                      <button type="button" data-v="50" class="active">50%</button>
                      <button type="button" data-v="75">75%</button>
                      <button type="button" data-v="100">100%</button>
                    </div>
                  </div>
                </div>
                <div class="field-row">
                  <div class="field">
                    <label for="plannedTime">é ç®—æ•™å­¸æ™‚é–“ï¼ˆåˆ†é˜ï¼‰</label>
                    <input type="number" id="plannedTime" min="0" placeholder="åˆ†é˜">
                  </div>
                  <div class="field">
                    <label for="actualTime">å¯¦éš›æ•™å­¸æ™‚é–“ï¼ˆåˆ†é˜ï¼‰</label>
                    <input type="number" id="actualTime" min="0" placeholder="åˆ†é˜">
                  </div>
                </div>
                <div class="field">
                  <label>æŠ€å·§ç­‰ç´šé€²åº¦</label>
                  <div class="option-btns" data-name="skillLevel">
                    <button type="button" data-v="åˆç´š">åˆç´š</button>
                    <button type="button" data-v="ä¸­ç´š">ä¸­ç´š</button>
                    <button type="button" data-v="é€²éš">é€²éš</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- åœ˜éšŠå”ä½œ -->
            <div class="card card-team">
              <h2 class="card-title">ğŸ¤ åœ˜éšŠå”ä½œ</h2>
              <div class="card-body">
                <div class="field">
                  <label>ä¸»å‹•å¹«åŠ©ä»–äºº <span class="range-val" id="val-helpOthers">50</span>%</label>
                  <div class="slider-row">
                    <input type="range" id="helpOthers" min="0" max="100" value="50">
                    <div class="quick-btns quick-pct" data-target="helpOthers">
                      <button type="button" data-v="0">0%</button>
                      <button type="button" data-v="25">25%</button>
                      <button type="button" data-v="50" class="active">50%</button>
                      <button type="button" data-v="75">75%</button>
                      <button type="button" data-v="100">100%</button>
                    </div>
                  </div>
                </div>
                <div class="field">
                  <label>åŒå­¸äº’å‹• <span class="range-val" id="val-interaction">50</span>%</label>
                  <div class="slider-row">
                    <input type="range" id="interaction" min="0" max="100" value="50">
                    <div class="quick-btns quick-pct" data-target="interaction">
                      <button type="button" data-v="0">0%</button>
                      <button type="button" data-v="25">25%</button>
                      <button type="button" data-v="50" class="active">50%</button>
                      <button type="button" data-v="75">75%</button>
                      <button type="button" data-v="100">100%</button>
                    </div>
                  </div>
                </div>
                <div class="field">
                  <label>å°çµ„åˆä½œæ„é¡˜ <span class="range-val" id="val-teamwork">50</span>%</label>
                  <div class="slider-row">
                    <input type="range" id="teamwork" min="0" max="100" value="50">
                    <div class="quick-btns quick-pct" data-target="teamwork">
                      <button type="button" data-v="0">0%</button>
                      <button type="button" data-v="25">25%</button>
                      <button type="button" data-v="50" class="active">50%</button>
                      <button type="button" data-v="75">75%</button>
                      <button type="button" data-v="100">100%</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- å¿ƒç†èˆ‡è‡ªä¿¡ -->
            <div class="card card-psych">
              <h2 class="card-title">ğŸ’¡ å¿ƒç†èˆ‡è‡ªä¿¡</h2>
              <div class="card-body">
                <div class="field">
                  <label>è‡ªç™¼ç·´ç¿’ <span class="range-val" id="val-selfPractice">50</span>%</label>
                  <div class="slider-row">
                    <input type="range" id="selfPractice" min="0" max="100" value="50">
                    <div class="quick-btns quick-pct" data-target="selfPractice">
                      <button type="button" data-v="0">0%</button>
                      <button type="button" data-v="25">25%</button>
                      <button type="button" data-v="50" class="active">50%</button>
                      <button type="button" data-v="75">75%</button>
                      <button type="button" data-v="100">100%</button>
                    </div>
                  </div>
                </div>
                <div class="field">
                  <label>ä¸»å‹•å­¸ç¿’ <span class="range-val" id="val-activeLearn">50</span>%</label>
                  <div class="slider-row">
                    <input type="range" id="activeLearn" min="0" max="100" value="50">
                    <div class="quick-btns quick-pct" data-target="activeLearn">
                      <button type="button" data-v="0">0%</button>
                      <button type="button" data-v="25">25%</button>
                      <button type="button" data-v="50" class="active">50%</button>
                      <button type="button" data-v="75">75%</button>
                      <button type="button" data-v="100">100%</button>
                    </div>
                  </div>
                </div>
                <div class="field">
                  <label>èª²å ‚ç©æ¥µæ€§ <span class="range-val" id="val-positivity">3</span>/5</label>
                  <div class="slider-row">
                    <input type="range" id="positivity" min="1" max="5" value="3">
                    <div class="quick-btns" data-target="positivity">
                      <button type="button" data-v="1">1</button>
                      <button type="button" data-v="2">2</button>
                      <button type="button" data-v="3" class="active">3</button>
                      <button type="button" data-v="4">4</button>
                      <button type="button" data-v="5">5</button>
                    </div>
                  </div>
                </div>
                <div class="field">
                  <label>å­¸ç¿’ç†±æƒ… <span class="range-val" id="val-enthusiasm">3</span>/5</label>
                  <div class="slider-row">
                    <input type="range" id="enthusiasm" min="1" max="5" value="3">
                    <div class="quick-btns" data-target="enthusiasm">
                      <button type="button" data-v="1">1</button>
                      <button type="button" data-v="2">2</button>
                      <button type="button" data-v="3" class="active">3</button>
                      <button type="button" data-v="4">4</button>
                      <button type="button" data-v="5">5</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- æ•™ç·´æ•™å­¸è³ªé‡ -->
            <div class="card">
              <h2 class="card-title">æ•™ç·´æ•™å­¸è³ªé‡</h2>
              <div class="card-body">
                <div class="field">
                  <label>æ•™å­¸è©•åˆ† <span class="range-val" id="val-teachScore">7</span>/10</label>
                  <div class="slider-row">
                    <input type="range" id="teachScore" min="1" max="10" value="7">
                    <div class="quick-btns" data-target="teachScore">
                      <button type="button" data-v="1">1</button>
                      <button type="button" data-v="5">5</button>
                      <button type="button" data-v="7" class="active">7</button>
                      <button type="button" data-v="10">10</button>
                    </div>
                  </div>
                </div>
                <div class="field">
                  <label>å­¸ç”Ÿæ»¿æ„åº¦ <span class="range-val" id="val-satisfaction">3</span>/5</label>
                  <div class="slider-row">
                    <input type="range" id="satisfaction" min="1" max="5" value="3">
                    <div class="quick-btns" data-target="satisfaction">
                      <button type="button" data-v="1">1</button>
                      <button type="button" data-v="2">2</button>
                      <button type="button" data-v="3" class="active">3</button>
                      <button type="button" data-v="4">4</button>
                      <button type="button" data-v="5">5</button>
                    </div>
                  </div>
                </div>
                <div class="field">
                  <label for="disciplineCount">èª²å ‚ç´€å¾‹ä»‹å…¥æ¬¡æ•¸</label>
                  <input type="number" id="disciplineCount" min="0" placeholder="æ¬¡æ•¸">
                </div>
                <div class="field">
                  <label>æ•™å­¸éˆæ´»æ€§ <span class="range-val" id="val-flexibility">7</span>/10</label>
                  <div class="slider-row">
                    <input type="range" id="flexibility" min="1" max="10" value="7">
                    <div class="quick-btns" data-target="flexibility">
                      <button type="button" data-v="1">1</button>
                      <button type="button" data-v="5">5</button>
                      <button type="button" data-v="7" class="active">7</button>
                      <button type="button" data-v="10">10</button>
                    </div>
                  </div>
                </div>
                <div class="field">
                  <label>å€‹åˆ¥åŒ–æ•™å­¸ <span class="range-val" id="val-individual">50</span>%</label>
                  <div class="slider-row">
                    <input type="range" id="individual" min="0" max="100" value="50">
                    <div class="quick-btns quick-pct" data-target="individual">
                      <button type="button" data-v="0">0%</button>
                      <button type="button" data-v="25">25%</button>
                      <button type="button" data-v="50" class="active">50%</button>
                      <button type="button" data-v="75">75%</button>
                      <button type="button" data-v="100">100%</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- æ“ä½œ -->
            <div class="card card-actions">
              <div class="card-body flex-row gap-m">
                <button type="button" id="btnSave" class="btn btn-primary">å„²å­˜æœ¬å ‚è¨˜éŒ„</button>
                <button type="button" id="btnClear" class="btn btn-ghost">æ¸…ç©ºæœ¬å ‚è¼¸å…¥</button>
              </div>
            </div>
          </div>
        </section>

        <!-- é é¢ï¼šå­¸ç”Ÿç®¡ç† -->
        <section id="page-students" class="page">
          <div class="page-inner">
            <!-- æœå°‹å’Œæ’åºå·¥å…· -->
            <div class="card">
              <h2 class="card-title">ğŸ” æœå°‹å’Œæ’åº</h2>
              <div class="card-body">
                <div class="search-box" style="margin-bottom: 1rem;">
                  <input type="text" id="studentSearch" placeholder="æœå°‹ç­ç´šåç¨±æˆ–æ—¥æœŸï¼ˆä¾‹ï¼šP3Aã€2025-01-20ï¼‰...">
                </div>
                <div class="sort-toolbar">
                  <label for="sortBy">æ’åºæ–¹å¼ï¼š</label>
                  <select id="sortBy">
                    <option value="date-desc">æœ€æ–°èª²ç¨‹å„ªå…ˆ</option>
                    <option value="date-asc">æœ€èˆŠèª²ç¨‹å„ªå…ˆ</option>
                    <option value="name-asc">ç­ç´šåç¨± (Aâ†’Z)</option>
                    <option value="mastery-desc">æŒæ¡åº¦ (é«˜â†’ä½)</option>
                    <option value="engagement-desc">é–‹å¿ƒæŒ‡æ•¸ (é«˜â†’ä½)</option>
                  </select>
                  <span class="sort-icon">âš™</span>
                </div>
              </div>
            </div>
            
            <!-- ç¯©é¸ -->
            <div class="card">
              <h2 class="card-title">ğŸ“… æ—¥æœŸç¯©é¸</h2>
              <div class="filter-row">
                <div class="field-inline">
                  <label for="filterDateFrom">æ—¥æœŸèµ·</label>
                  <input type="date" id="filterDateFrom">
                </div>
                <div class="field-inline">
                  <label for="filterDateTo">æ—¥æœŸè¨–</label>
                  <input type="date" id="filterDateTo">
                </div>
              </div>
            </div>
            
            <div class="students-grid">
            <div class="card">
              <h2 class="card-title">ğŸ“š æŒ‰ç­åˆ¥</h2>
              <div class="card-body">
                <ul id="byClassList" class="by-class-list"></ul>
              </div>
            </div>
            <div class="card">
              <h2 class="card-title">â± æœ€è¿‘ 10 å ‚èª²</h2>
              <div class="card-body">
                <ul id="recentList" class="recent-list"></ul>
              </div>
            </div>
            </div>
          </div>
        </section>

        <!-- é é¢ï¼šå‹•ä½œè¨˜éŒ„ -->
        <section id="page-actions" class="page">
          <div class="page-inner">
            <div class="card">
              <h2 class="card-title">æ•™å­¸èŠ±å¼è¨˜éŒ„</h2>
              <div class="filter-row">
                <div class="field-inline">
                  <label for="actionFilterClass">ç­åˆ¥</label>
                  <select id="actionFilterClass">
                    <option value="">å…¨éƒ¨</option>
                  </select>
                </div>
                <div class="field-inline">
                  <label for="actionDateFrom">æ—¥æœŸèµ·</label>
                  <input type="date" id="actionDateFrom">
                </div>
                <div class="field-inline">
                  <label for="actionDateTo">æ—¥æœŸè¨–</label>
                  <input type="date" id="actionDateTo">
                </div>
                <div class="field-inline">
                  <label for="actionSkillLevel">æŠ€å·§ç­‰ç´š</label>
                  <select id="actionSkillLevel">
                    <option value="">å…¨éƒ¨</option>
                    <option value="åˆç´š">åˆç´š</option>
                    <option value="ä¸­ç´š">ä¸­ç´š</option>
                    <option value="é€²éš">é€²éš</option>
                  </select>
                </div>
              </div>
              <div class="card-body card-body-table">
                <div class="table-wrap">
                  <table class="data-table">
                    <thead>
                      <tr>
                        <th>æ—¥æœŸ</th>
                        <th>ç­ç´š</th>
                        <th>èŠ±å¼åç¨±</th>
                        <th>æ•™å­¸ç´°ç¯€</th>
                        <th>æŒæ¡æ¯”ä¾‹</th>
                      </tr>
                    </thead>
                    <tbody id="actionsTableBody"></tbody>
                  </table>
                </div>
                <p id="actionsEmpty" class="empty-hint" hidden>å°šç„¡æ•™å­¸èŠ±å¼è¨˜éŒ„</p>
              </div>
            </div>
          </div>
        </section>

        <!-- é é¢ï¼šçµ±è¨ˆåˆ†æ -->
        <section id="page-analytics" class="page">
          <div class="page-inner">
            <div class="card">
              <h2 class="card-title">ç¯©é¸</h2>
              <div class="filter-row">
                <div class="field-inline">
                  <label for="analyticsFilterClass">ç­åˆ¥</label>
                  <select id="analyticsFilterClass">
                    <option value="">å…¨éƒ¨</option>
                  </select>
                </div>
                <div class="field-inline">
                  <label for="analyticsDateFrom">æ—¥æœŸèµ·</label>
                  <input type="date" id="analyticsDateFrom">
                </div>
                <div class="field-inline">
                  <label for="analyticsDateTo">æ—¥æœŸè¨–</label>
                  <input type="date" id="analyticsDateTo">
                </div>
              </div>
            </div>
            <!-- çµ±è¨ˆ stripï¼ˆç°¡æ½”ï¼Œéå¡ç‰‡ï¼‰-->
            <div class="stats-strip">
              <span>ç¸½è¨˜éŒ„ <strong id="statTotal">0</strong></span>
              <span class="sep">|</span>
              <span>æœ¬é€± <strong id="statWeek">0</strong></span>
              <span class="sep">|</span>
              <span>å¹³å‡(1â€“5) <strong id="statAvg">â€“</strong></span>
              <span class="sep">|</span>
              <span>æœ€è¿‘ <strong id="statUpdated">â€“</strong></span>
            </div>
            <!-- ç­åˆ¥çµ±è¨ˆï¼ˆç°¡åŒ–ç‚ºè¡¨æ ¼ï¼‰ -->
            <div class="card">
              <h2 class="card-title">ç­åˆ¥çµ±è¨ˆ</h2>
              <div class="card-body">
                <div id="analyticsChart" class="analytics-table"></div>
                <p id="analyticsEmpty" class="empty-hint" hidden>å°šç„¡è¨˜éŒ„</p>
              </div>
            </div>
            <!-- æ•¸æ“šç®¡ç† -->
            <div class="card">
              <h2 class="card-title">æ•¸æ“šç®¡ç†</h2>
              <div class="card-body flex-row gap-m">
                <button type="button" id="btnExport" class="btn btn-ghost">åŒ¯å‡ºå…¨éƒ¨è¨˜éŒ„ï¼ˆCSVï¼‰</button>
                <button type="button" id="btnDeleteAll" class="btn btn-danger-ghost">æ¸…é™¤æ‰€æœ‰è¨˜éŒ„</button>
              </div>
            </div>
          </div>
        </section>

        <!-- é é¢ï¼šç”¨æˆ¶ç®¡ç†ï¼ˆåƒ… Creator å¯è¦‹ï¼‰ -->
        <section id="page-data" class="page" hidden>
          <div class="page-inner">
            <!-- ç”¨æˆ¶åˆ—è¡¨ -->
            <div class="card">
              <h2 class="card-title">ğŸ‘¥ ç³»çµ±ç”¨æˆ¶</h2>
              <div class="card-body">
                <div id="usersList" class="users-list"></div>
                <p id="usersEmpty" class="empty-hint" hidden>å°šç„¡ç”¨æˆ¶</p>
              </div>
            </div>

            <!-- ç³»çµ±çµ±è¨ˆ -->
            <div class="card">
              <h2 class="card-title">ğŸ“Š ç³»çµ±çµ±è¨ˆ</h2>
              <div class="card-body">
                <div class="stats-grid">
                  <div class="stat-card">
                    <div class="stat-label">ç¸½ç”¨æˆ¶æ•¸</div>
                    <div class="stat-number" id="statTotalUsers">0</div>
                  </div>
                  <div class="stat-card">
                    <div class="stat-label">Creator æ•¸</div>
                    <div class="stat-number" id="statCreatorCount">0</div>
                  </div>
                  <div class="stat-card">
                    <div class="stat-label">æ™®é€šç”¨æˆ¶</div>
                    <div class="stat-number" id="statUserCount">0</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>
  </div>

  <!-- Modals -->
  <div id="classDetailModal" class="modal" hidden>
    <div class="modal-backdrop"></div>
    <div class="modal-dialog">
      <div class="modal-header">
        <h3 id="classDetailTitle">ç­åˆ¥ç´°ç¯€</h3>
        <button type="button" id="closeClassDetail" class="modal-close" aria-label="é—œé–‰">&times;</button>
      </div>
      <div id="classDetailBody" class="modal-body"></div>
    </div>
  </div>
  <div id="detailModal" class="modal" hidden>
    <div class="modal-backdrop"></div>
    <div class="modal-dialog">
      <div class="modal-header">
        <h3 id="detailTitle">èª²å ‚è©³æƒ…</h3>
        <button type="button" id="closeDetail" class="modal-close" aria-label="é—œé–‰">&times;</button>
      </div>
      <div id="detailBody" class="modal-body"></div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast" hidden></div>

  <!-- PouchDB æ¨¡çµ„ -->
  <script src="pouchdb-config.js"></script>
  <script src="pouchdb-storage.js"></script>
  <script src="crypto-keys.js"></script>
  <script src="user-auth.js"></script>
  <script src="pouchdb-integration.js"></script>
  <script src="pouchdb-app-compat.js"></script>
  
  <!-- ä¸»æ‡‰ç”¨ -->
  <script src="app.js"></script>
  
  <!-- åˆå§‹åŒ–è…³æœ¬ -->
  <script>
    // æ‡‰ç”¨å•Ÿå‹•
    document.addEventListener('DOMContentLoaded', async function() {
      console.log('ğŸš€ æ‡‰ç”¨å•Ÿå‹•ä¸­...');
      
      // æª¢æŸ¥ç”¨æˆ¶æ˜¯å¦å·²ç™»éŒ„ï¼ˆåŠ å¼·é©—è­‰ï¼‰
      const session = localStorage.getItem('rs-system-session');
      const currentUser = localStorage.getItem('current-user');
      
      console.log('ğŸ“‹ æœƒè©±æª¢æŸ¥:', {
        hasSession: !!session,
        hasCurrentUser: !!currentUser
      });
      
      if (!session || !currentUser) {
        console.warn('âš ï¸ ç”¨æˆ¶æœªç™»éŒ„ï¼Œé‡å®šå‘åˆ°ç™»éŒ„é é¢');
        console.log('   session:', session ? 'âœ“ å­˜åœ¨' : 'âœ— ç¼ºå¤±');
        console.log('   current-user:', currentUser ? 'âœ“ å­˜åœ¨' : 'âœ— ç¼ºå¤±');
        
        // æ¸…é™¤ä»»ä½•æ®˜ç•™æœƒè©±
        localStorage.removeItem('rs-system-session');
        localStorage.removeItem('current-user');
        
        window.location.href = 'login.html';
        return;
      }
      
      try {
        // é©—è­‰æœƒè©±æ•¸æ“šæ ¼å¼
        const sessionData = JSON.parse(session);
        const userData = JSON.parse(currentUser);
        
        console.log('âœ… æœƒè©±é©—è­‰æˆåŠŸ');
        console.log('   ç”¨æˆ¶:', sessionData.username);
        console.log('   ç™»å…¥æ™‚é–“:', sessionData.loginTime);
      } catch (e) {
        console.error('âŒ æœƒè©±æ•¸æ“šæ ¼å¼éŒ¯èª¤:', e.message);
        localStorage.removeItem('rs-system-session');
        localStorage.removeItem('current-user');
        window.location.href = 'login.html';
        return;
      }
      
      // åˆå§‹åŒ–å„²å­˜ç³»çµ±
      const success = await initializeApp();
      if (!success) {
        console.error('âŒ å„²å­˜ç³»çµ±åˆå§‹åŒ–å¤±æ•—ï¼Œæ‡‰ç”¨å°‡åœ¨é›¢ç·šæ¨¡å¼é‹è¡Œ');
      }
      
      // æ›´æ–°å´é‚Šæ¬„ç”¨æˆ¶ä¿¡æ¯
      try {
        const userData = JSON.parse(currentUser);
        const userNameEl = document.getElementById('sidebarUserName');
        if (userNameEl) {
          userNameEl.textContent = userData.username || 'æœªçŸ¥ç”¨æˆ¶';
        }
      } catch (e) {
        console.warn('âš ï¸ ç„¡æ³•æ›´æ–°ç”¨æˆ¶ä¿¡æ¯:', e.message);
      }
    });
  </script>
</body>
</html>
