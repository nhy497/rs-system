# ğŸ›ï¸ ç³»çµ±æ¶æ§‹

## æ¶æ§‹æ¦‚è¿°

RS-System æ˜¯ä¸€å€‹è¼•é‡ç´šçš„å–®é æ‡‰ç”¨ï¼ˆSPAï¼‰ï¼Œæ¡ç”¨æ¨¡çµ„åŒ–æ¶æ§‹è¨­è¨ˆã€‚

```
å‰ç«¯æ‡‰ç”¨ (Client)
â”œâ”€â”€ å±•ç¤ºå±¤ (Presentation Layer)
â”‚   â”œâ”€â”€ HTML é é¢
â”‚   â”œâ”€â”€ CSS æ¨£å¼
â”‚   â””â”€â”€ UI çµ„ä»¶
â”‚
â”œâ”€â”€ æ‡‰ç”¨å±¤ (Application Layer)
â”‚   â”œâ”€â”€ æ¥­å‹™é‚è¼¯
â”‚   â”œâ”€â”€ ç‹€æ…‹ç®¡ç†
â”‚   â””â”€â”€ è·¯ç”±æ§åˆ¶
â”‚
â”œâ”€â”€ æœå‹™å±¤ (Service Layer)
â”‚   â”œâ”€â”€ è³‡æ–™æœå‹™
â”‚   â”œâ”€â”€ åŒæ­¥æœå‹™
â”‚   â””â”€â”€ æ—¥èªŒæœå‹™
â”‚
â””â”€â”€ è³‡æ–™å±¤ (Data Layer)
    â”œâ”€â”€ localStorage
    â””â”€â”€ IndexedDB

å¯é¸å¾Œç«¯ (Optional Backend)
â””â”€â”€ Firebase / PouchDB
    â””â”€â”€ é›²ç«¯åŒæ­¥
```

## æ ¸å¿ƒæ¨¡çµ„

### 1. åˆå§‹åŒ–æ¨¡çµ„ (Initialization)

**ä½ç½®**: `src/init/`

- `app-init.js` - ä¸»æ‡‰ç”¨åˆå§‹åŒ–
- `login-page-init.js` - ç™»å…¥é åˆå§‹åŒ–
- `config.js` - é…ç½®ç®¡ç†

**è·è²¬**:
- è‡ªå‹•åµæ¸¬é é¢é¡å‹ï¼ˆç™»å…¥é /ä¸»æ‡‰ç”¨ï¼‰
- åŸ·è¡Œå°æ‡‰çš„åˆå§‹åŒ–æµç¨‹
- è¨­å®šå…¨åŸŸé…ç½®

### 2. æœå‹™å±¤ (Services)

**ä½ç½®**: `src/services/`

- `logger.js` - æ—¥èªŒæœå‹™
- `sync-utils.js` - åŒæ­¥å·¥å…·
- `data-service.js` - è³‡æ–™æœå‹™

**è·è²¬**:
- æä¾›å¯é‡ç”¨çš„æœå‹™åŠŸèƒ½
- å°è£è¤‡é›œçš„æ¥­å‹™é‚è¼¯
- çµ±ä¸€çš„éŒ¯èª¤è™•ç†

### 3. å·¥å…·æ¨¡çµ„ (Utilities)

**ä½ç½®**: `src/utils/`

- `dom-utils.js` - DOM æ“ä½œå·¥å…·
- `helpers.js` - é€šç”¨è¼”åŠ©å‡½æ•¸
- `formatters.js` - è³‡æ–™æ ¼å¼åŒ–
- `validators.js` - è³‡æ–™é©—è­‰

**è·è²¬**:
- æä¾›ç´”å‡½æ•¸å·¥å…·
- é›¶ä¾è³´å¯¦ç¾
- æ”¯æ´ç€è¦½å™¨å’Œ Node.js ç’°å¢ƒ

### 4. é…ç½®æ¨¡çµ„ (Configuration)

**ä½ç½®**: `src/config/`

- `firebase.js` - Firebase é…ç½®
- `sync.js` - åŒæ­¥é…ç½®

**è·è²¬**:
- ç®¡ç†ç¬¬ä¸‰æ–¹æœå‹™é…ç½®
- ç’°å¢ƒè®Šæ•¸è™•ç†
- åŠŸèƒ½é–‹é—œ

### 5. å¸¸æ•¸æ¨¡çµ„ (Constants)

**ä½ç½®**: `src/constants/`

- `app-constants.js` - æ‡‰ç”¨å¸¸æ•¸

**è·è²¬**:
- å®šç¾©ç³»çµ±å¸¸æ•¸
- çµ±ä¸€é­”è¡“æ•¸å­—
- æä¾›å‹åˆ¥å®šç¾©

### 6. ç›¸å®¹å±¤ (Compatibility)

**ä½ç½®**: `src/compat/`

- `legacy-bridge.js` - èˆŠç‰ˆç›¸å®¹æ©‹æ¥

**è·è²¬**:
- ä¿æŒå‘å¾Œç›¸å®¹
- æ¼¸é€²å¼é·ç§»
- é›¶ç ´å£æ€§è®Šæ›´

## è³‡æ–™æ¨¡å‹

### User ç‰©ä»¶

```javascript
{
  id: "uuid-string",
  username: "creator",
  password: "hashed-password",
  email: "user@example.com",
  role: "creator" | "user",
  createdAt: "2026-01-24T10:30:00.000Z"
}
```

### Record ç‰©ä»¶

```javascript
{
  recordId: "uuid-string",
  date: "2026-02-18",
  className: "Aç­",
  studentCount: 15,
  skills: ["åŸºæœ¬è·³", "å–®è…³è·³"],
  notes: "èª²å ‚è¡¨ç¾è‰¯å¥½",
  createdBy: "user-id",
  createdAt: "2026-02-18T10:30:00.000Z",
  updatedAt: "2026-02-18T10:30:00.000Z"
}
```

### Session ç‰©ä»¶

```javascript
{
  userId: "uuid-string",
  username: "creator",
  role: "creator",
  loginTime: "2026-02-18T10:00:00.000Z",
  lastActivity: "2026-02-18T10:30:00.000Z",
  expiresAt: "2026-02-18T18:00:00.000Z"
}
```

## è³‡æ–™æµ

### 1. ç”¨æˆ¶ç™»å…¥æµç¨‹

```
ç”¨æˆ¶è¼¸å…¥ â†’ é©—è­‰ â†’ å»ºç«‹ Session â†’ å„²å­˜ localStorage â†’ é‡å®šå‘
```

### 2. è¨˜éŒ„å»ºç«‹æµç¨‹

```
è¡¨å–®è¼¸å…¥ â†’ é©—è­‰ â†’ ç”Ÿæˆ ID â†’ å„²å­˜ localStorage â†’ å‚™ä»½ IndexedDB â†’ æ›´æ–° UI
```

### 3. è³‡æ–™åŒæ­¥æµç¨‹ï¼ˆå¯é¸ï¼‰

```
æœ¬åœ°è®Šæ›´ â†’ åµæ¸¬ â†’ ä¸Šå‚³ Firebase â†’ ä¸‹è¼‰é ç«¯è®Šæ›´ â†’ åˆä½µ â†’ æ›´æ–°æœ¬åœ°
```

## å„²å­˜ç­–ç•¥

### é›™é‡å‚™ä»½æ©Ÿåˆ¶

1. **localStorage** (ä¸»è¦å„²å­˜)
   - å³æ™‚è®€å¯«
   - è‡ªå‹•åºåˆ—åŒ–
   - åŒæ­¥ API

2. **IndexedDB** (å‚™ä»½å„²å­˜)
   - å¤§å®¹é‡æ”¯æ´
   - çµæ§‹åŒ–å„²å­˜
   - éåŒæ­¥ API

### è³‡æ–™å‘½åè¦ç¯„

```
localStorage éµå€¼:
- users                    # ç”¨æˆ¶åˆ—è¡¨
- current-user            # ç•¶å‰ç”¨æˆ¶
- rs-system-session       # æœƒè©±è³‡æ–™
- rs-system-{userId}      # ç”¨æˆ¶è¨˜éŒ„ï¼ˆèˆŠç‰ˆï¼‰

IndexedDB è³‡æ–™åº«:
- rs-system-{userId}      # ç”¨æˆ¶å°ˆå±¬è³‡æ–™åº«
```

## æŠ€è¡“æ£§

### å‰ç«¯

| æŠ€è¡“ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| HTML5 | - | é é¢çµæ§‹ |
| CSS3 | - | æ¨£å¼è¨­è¨ˆ |
| JavaScript | ES6+ | æ‡‰ç”¨é‚è¼¯ |
| Vite | ^5.0.12 | å»ºç½®å·¥å…· |

### æ¸¬è©¦

| æŠ€è¡“ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Vitest | ^1.2.2 | æ¸¬è©¦æ¡†æ¶ |
| @vitest/ui | ^1.2.2 | æ¸¬è©¦ UI |

### é–‹ç™¼å·¥å…·

| æŠ€è¡“ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| ESLint | ^8.56.0 | ä»£ç¢¼æª¢æŸ¥ |
| Prettier | ^3.2.4 | ä»£ç¢¼æ ¼å¼åŒ– |
| TypeScript | ^5.3.3 | å‹åˆ¥æª¢æŸ¥ |

### å„²å­˜

| æŠ€è¡“ | ç”¨é€” |
|------|------|
| localStorage | æœ¬åœ°å³æ™‚å„²å­˜ |
| IndexedDB | æœ¬åœ°æŒä¹…åŒ–å„²å­˜ |
| PouchDB | é›¢ç·šåŒæ­¥ï¼ˆå¯é¸ï¼‰ |
| Firebase | é›²ç«¯å„²å­˜ï¼ˆå¯é¸ï¼‰ |

## éƒ¨ç½²æ¶æ§‹

### GitHub Pages éƒ¨ç½²

```
GitHub Repository
    â†“
GitHub Actions (CI/CD)
    â†“
Build (Vite)
    â†“
Deploy to gh-pages branch
    â†“
GitHub Pages Hosting
```

### æª”æ¡ˆçµæ§‹

```
rs-system/
â”œâ”€â”€ src/                    # åŸå§‹ç¢¼
â”‚   â”œâ”€â”€ init/              # åˆå§‹åŒ–æ¨¡çµ„
â”‚   â”œâ”€â”€ services/          # æœå‹™å±¤
â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•¸
â”‚   â”œâ”€â”€ config/            # é…ç½®
â”‚   â”œâ”€â”€ constants/         # å¸¸æ•¸
â”‚   â”œâ”€â”€ compat/            # ç›¸å®¹å±¤
â”‚   â”œâ”€â”€ main.js            # ä¸»å…¥å£ï¼ˆES æ¨¡çµ„ï¼‰
â”‚   â””â”€â”€ index.js           # è‡ªå‹•åˆå§‹åŒ–å…¥å£
â”‚
â”œâ”€â”€ public/                # éœæ…‹è³‡æº
â”‚   â”œâ”€â”€ index.html         # ä¸»é é¢
â”‚   â”œâ”€â”€ login.html         # ç™»å…¥é 
â”‚   â””â”€â”€ system.js          # æ ¸å¿ƒé‚è¼¯ï¼ˆèˆŠç‰ˆï¼‰
â”‚
â”œâ”€â”€ tests/                 # æ¸¬è©¦
â”‚   â”œâ”€â”€ manual/            # æ‰‹å‹•æ¸¬è©¦
â”‚   â””â”€â”€ unit/              # å–®å…ƒæ¸¬è©¦
â”‚
â”œâ”€â”€ docs/                  # æ–‡æª”
â”‚   â”œâ”€â”€ README.md          # æ–‡æª”é¦–é 
â”‚   â”œâ”€â”€ api/               # API æ–‡æª”
â”‚   â””â”€â”€ archive/           # æ­·å²æ–‡æª”
â”‚
â””â”€â”€ dist/                  # å»ºç½®è¼¸å‡º
```

## è¨­è¨ˆåŸå‰‡

### 1. é›¶ç ´å£æ€§è®Šæ›´

- æ‰€æœ‰æ–°åŠŸèƒ½éƒ½æ˜¯æ–°å¢æ¨¡çµ„
- èˆŠç‰ˆ `system.js` å®Œå…¨æœªä¿®æ”¹
- ä¿æŒå‘å¾Œç›¸å®¹

### 2. æ¨¡çµ„åŒ–è¨­è¨ˆ

- åŠŸèƒ½ç¨ç«‹å°è£
- æ¸…æ™°çš„ä»‹é¢å®šç¾©
- æœ€å°ä¾è³´åŸå‰‡

### 3. æ¼¸é€²å¼å¢å¼·

- åŸºç¤åŠŸèƒ½å„ªå…ˆ
- å¯é¸åŠŸèƒ½æ’ä»¶åŒ–
- å„ªé›…é™ç´š

### 4. è‡ªå‹•åŒ–å„ªå…ˆ

- è‡ªå‹•åµæ¸¬é é¢é¡å‹
- è‡ªå‹•åŸ·è¡Œåˆå§‹åŒ–
- æ¸›å°‘æ‰‹å‹•é…ç½®

## æ•ˆèƒ½è€ƒé‡

### 1. è¼‰å…¥æ•ˆèƒ½

- ES æ¨¡çµ„å‹•æ…‹è¼‰å…¥
- æŒ‰éœ€è¼‰å…¥è³‡æº
- æœ€å°åŒ–å»ºç½®è¼¸å‡º

### 2. åŸ·è¡Œæ•ˆèƒ½

- localStorage å¿«å–
- äº‹ä»¶å§”æ´¾
- é˜²æŠ–/ç¯€æµ

### 3. å„²å­˜æ•ˆèƒ½

- æ‰¹æ¬¡å¯«å…¥
- è³‡æ–™å£“ç¸®
- å®šæœŸæ¸…ç†

## å®‰å…¨æ€§

### 1. è³‡æ–™å®‰å…¨

- å¯†ç¢¼æ‡‰åŠ å¯†å„²å­˜ï¼ˆå¾…å¯¦ç¾ï¼‰
- XSS é˜²è­·
- CSRF é˜²è­·

### 2. å­˜å–æ§åˆ¶

- è§’è‰²æ¬Šé™ç®¡ç†
- Creator ç‰¹æ¬Šæª¢æŸ¥
- æœƒè©±éæœŸæ©Ÿåˆ¶

## æ“´å±•æ€§

### 1. æ°´å¹³æ“´å±•

- æ”¯æ´å¤šç”¨æˆ¶
- æ”¯æ´è³‡æ–™åˆ†ç‰‡

### 2. å‚ç›´æ“´å±•

- æ¨¡çµ„åŒ–æ¶æ§‹
- æ’ä»¶ç³»çµ±
- ä¸»é¡Œç³»çµ±

## ç›¸é—œæ–‡æª”

- [ğŸ“Š æ•¸æ“šæ¨¡å‹](./archive/old-structure/architecture/DATA_MODEL.md)
- [ğŸ› ï¸ æŠ€è¡“æ£§](./archive/old-structure/architecture/TECH_STACK.md)
- [ğŸ’» é–‹ç™¼æŒ‡å—](./development.md)
- [ğŸ§ª æ¸¬è©¦æŒ‡å—](./testing.md)

---

**ç‰ˆæœ¬**: v3.1  
**æœ€å¾Œæ›´æ–°**: 2026-02-18
